{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user within the Project Sentinel application.",
      "properties": {
        "uid": {
          "type": "string",
          "description": "Unique identifier for the user. (Primary Key)"
        },
        "role": {
          "type": "string",
          "description": "The role of the user within the application ('admin' or 'manager').",
          "enum": ["admin", "manager"]
        },
        "name": {
          "type": "string",
          "description": "The user's full name."
        },
        "email": {
          "type": "string",
          "description": "The user's email address.",
          "format": "email"
        },
        "assigned_project_ids": {
          "type": "array",
          "description": "References to Projects that the user is assigned to.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "uid",
        "role",
        "name",
        "email"
      ]
    },
    "Project": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Project",
      "type": "object",
      "description": "Represents a project within the Project Sentinel application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the project. (Primary Key)"
        },
        "name": {
          "type": "string",
          "description": "The name of the project."
        },
        "location": {
          "type": "string",
          "description": "The location of the project."
        },
        "budget_limit": {
          "type": "number",
          "description": "The budget limit for the project."
        },
        "assigned_manager_id": {
          "type": "string",
          "description": "Reference to User assigned as manager."
        },
        "status": {
          "type": "string",
          "description": "The status of the project.",
          "enum": ["active", "completed"]
        }
      },
      "required": [
        "id",
        "name",
        "location",
        "budget_limit",
        "assigned_manager_id",
        "status"
      ]
    },
    "Worker": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Worker",
      "type": "object",
      "description": "Represents a worker within the Project Sentinel application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the worker. (Primary Key)"
        },
        "name": {
          "type": "string",
          "description": "The name of the worker."
        },
        "skill": {
          "type": "string",
          "description": "The worker's skill."
        },
        "phone": {
          "type": "string",
          "description": "The worker's phone number."
        },
        "payment_type": {
          "type": "string",
          "description": "The worker's payment type.",
          "enum": ["hourly", "daily", "monthly"]
        },
        "base_rate": {
          "type": "number",
          "description": "The worker's base rate."
        },
        "current_balance": {
          "type": "number",
          "description": "The worker's current balance."
        }
      },
      "required": [
        "id",
        "name",
        "skill",
        "phone",
        "payment_type",
        "base_rate",
        "current_balance"
      ]
    },
    "Transaction": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Transaction",
      "type": "object",
      "description": "Represents a transaction within the Project Sentinel application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the transaction. (Primary Key)"
        },
        "project_id": {
          "type": "string",
          "description": "Optional reference to a Project."
        },
        "type": {
          "type": "string",
          "description": "The type of transaction.",
          "enum": ["expense", "income", "payout_advance", "payout_settlement"]
        },
        "amount": {
          "type": "number",
          "description": "The amount of the transaction."
        },
        "category": {
          "type": "string",
          "description": "The category of the transaction."
        },
        "description": {
          "type": "string",
          "description": "A description of the transaction."
        },
        "proof_image_url": {
          "type": "string",
          "description": "URL of the proof image for the transaction.",
          "format": "uri"
        },
        "worker_id": {
            "type": "string",
            "description": "Optional reference to a worker for payout transactions."
        },
        "timestamp": {
          "type": "string",
          "description": "The timestamp of the transaction.",
          "format": "date-time"
        },
        "created_by": {
            "type": "string",
            "description": "UID of the user who created the transaction."
        },
        "status": {
            "type": "string",
            "description": "The approval status of the transaction.",
            "enum": ["unapproved", "approved", "rejected"]
        }
      },
      "required": [
        "id",
        "type",
        "amount",
        "category",
        "description",
        "timestamp",
        "created_by",
        "status"
      ]
    },
    "Task": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Task",
      "type": "object",
      "description": "Represents a task within the Project Sentinel application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the task. (Primary Key)"
        },
        "project_id": {
          "type": "string",
          "description": "Reference to Project."
        },
        "title": {
          "type": "string",
          "description": "The title of the task."
        },
        "description": {
          "type": "string",
          "description": "A detailed description of the task."
        },
        "status": {
          "type": "string",
          "description": "The status of the task.",
          "enum": ["todo", "inprogress", "done"]
        },
        "completion_photo_url": {
          "type": "string",
          "description": "URL of the completion photo for the task.",
          "format": "uri"
        },
        "expected_completion_date": {
            "type": "string",
            "description": "The expected completion date for the task.",
            "format": "date-time"
        }
      },
      "required": [
        "id",
        "project_id",
        "title",
        "status"
      ]
    },
    "Attendance": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Attendance",
      "type": "object",
      "description": "Represents an attendance record within the Project Sentinel application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the attendance record. (Primary Key)"
        },
        "date": {
          "type": "string",
          "description": "The date of the attendance record.",
          "format": "date-time"
        },
        "worker_id": {
          "type": "string",
          "description": "Reference to Worker."
        },
        "project_id": {
          "type": "string",
          "description": "Reference to Project."
        },
        "status": {
          "type": "string",
          "description": "The status of the attendance record.",
          "enum": ["present", "absent"]
        },
        "units_worked": {
          "type": "number",
          "description": "The number of units worked during the attendance record."
        }
      },
      "required": [
        "id",
        "date",
        "worker_id",
        "project_id",
        "status",
        "units_worked"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profiles, including their role ('admin' or 'manager')."
        }
      },
      {
        "path": "/projects/{projectId}",
        "definition": {
          "entityName": "Project",
          "schema": {
            "$ref": "#/backend/entities/Project"
          },
          "description": "Stores project information."
        }
      },
      {
        "path": "/projects/{projectId}/transactions/{transactionId}",
        "definition": {
          "entityName": "Transaction",
          "schema": {
            "$ref": "#/backend/entities/Transaction"
          },
          "description": "Stores transactions associated with a project."
        }
      },
       {
        "path": "/transactions/{transactionId}",
        "definition": {
          "entityName": "Transaction",
          "schema": {
            "$ref": "#/backend/entities/Transaction"
          },
          "description": "Stores global transactions not associated with a specific project (e.g., admin payroll)."
        }
      },
      {
        "path": "/projects/{projectId}/tasks/{taskId}",
        "definition": {
          "entityName": "Task",
          "schema": {
            "$ref": "#/backend/entities/Task"
          },
          "description": "Stores tasks associated with a project."
        }
      },
      {
        "path": "/attendance/{attendanceId}",
        "definition": {
          "entityName": "Attendance",
          "schema": {
            "$ref": "#/backend/entities/Attendance"
          },
          "description": "Stores all attendance records. A composite key on worker_id and date must be enforced."
        }
      },
      {
        "path": "/workers/{workerId}",
        "definition": {
          "entityName": "Worker",
          "schema": {
            "$ref": "#/backend/entities/Worker"
          },
          "description": "Stores worker profiles globally."
        }
      }
    ]
  }
}
